<?php

/**
 * @file
 *  The main file for the Brafton Importer module
 */

/**
 * Implements hook_cron().
 *
 * Imports XML articles on schedule.
 */
function brafton_importer_cron() {

//  $queue = \Drupal::queue('brafton_cron');

//  \Drupal\brafton_importer\BraftonImporterService::createBraftonArticle();

//  \Drupal::service('brafton_importer.brafton_importer_service')->createBraftonArticle();

//    $article_loader = new \Drupal\brafton_importer\Model\BraftonArticleLoader();
//    $article_loader->import_articles();

}

/**
 * Implements hook_element_info_alter()
 */
// Use to insert atlantis script more selectively
/*
function brafton_importer_element_info_alter(array &$types) {
  if (isset($types['text_long'])) {
    $types['text_long']['html_head']['#attached']['library'][] = 'brafton_importer/atlantisjs';
  }
}
*/

/**
 * Implements hook_page_attachments_alter
 */
/*
function brafton_importer_page_attachments_alter(array &$page) {
  $config = \Drupal::configFactory()->getEditable('brafton_importer.settings');
  if( $config->get('brafton_importer.brafton_video_atlantis_switch') ) {
<<<<<<< HEAD
    $page['#attached']['library'][] = 'brafton_importer/atlantisjs';
    debug($page);
=======
    $page['#attached']['html_head']['library'][] = 'brafton_importer/atlantisjs';
>>>>>>> 7e338b9e61f096ebb2985e3fb9b1c189e24d2a24
  }
}
*/
/**
 * Implements hook_page_attachments_alter
 *
 * Puts Atlantis css and js in head section. Drupal way is to use library.yml file but it only injects at end.
 */
function brafton_importer_page_attachments_alter(array &$page) {
  $config = \Drupal::configFactory()->getEditable('brafton_importer.settings');
  if( $config->get('brafton_importer.brafton_video_atlantis_switch') ) {


    $page['#attached']['html_head_link'][] = array( array( 'rel' => 'stylesheet', 'href' => 'http://atlantisjs.brafton.com/v1/atlantisjsv1.3.css'  ), 'atlantis_css' );
    $page['#attached']['html_head'][] = array( array( '#tag' => 'script', '#attributes' => array( 'src' => 'https://code.jquery.com/jquery-2.1.4.min.js' )  ), 'jquery' );
    $page['#attached']['html_head'][] = array( array( '#tag' => 'script', '#attributes' => array( 'src' => 'http://atlantisjs.brafton.com/v1/atlantis.min.v1.3.js' )  ), 'atlantis_js' );


  }
}

/*
function brafton_importer_page_attachments(array &$page){
    $page['#attached']['html_head']['library'][] = 'brafton_importer/atlantisjs';
}
*/


/*
$new_node_info = array( ,
  'type' => 'article',
  'title' => 'New testing article'
);

$new_node = entity_create('node', $new_node_info);
$new_node->save();
*/
?>
